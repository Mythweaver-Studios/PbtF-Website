<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voiceline Timing Helper</title>
    <!-- WaveSurfer.js from a CDN -->
    <script src="https://unpkg.com/wavesurfer.js"></script>
    <!-- Link to external stylesheet -->
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <aside id="shortcuts-panel" class="shortcuts-panel">
        <button id="shortcuts-toggle" class="shortcuts-toggle" title="Toggle Shortcuts Panel">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z" />
            </svg>
        </button>
        <div class="shortcuts-content">
            <h4>Shortcuts</h4>
            <ul>
                <li><span>Space</span> Play / Pause Audio</li>
                <li><span>G</span> Set Word Time</li>
                <li><span>R</span> Rewind to Start</li>
                <li><span>← / →</span> Scrub -/+ 1s</li>
            </ul>
            <p class="help-note">Shortcuts are disabled when typing in the Quote Text field.</p>
        </div>
    </aside>

    <main class="main-content">
        <div class="card">
            <h1>Voiceline Timing Helper by Solo</h1>
            <p>A stable and reliable tool to generate the `timedQuote` JSON for character voicelines.</p>
        </div>

        <div class="card">
            <h2>1. Setup</h2>
            <div class="audio-controls">
                <input type="file" id="audioFile" accept="audio/*" style="flex-grow: 1;">
                <button id="playBtn" disabled>Play / Pause</button>
                <button id="autoplayBtn" disabled>Autoplay</button>
            </div>
            <div class="audio-info">
                <span id="status">Load an audio file to begin.</span>
                <span id="time-display">0.00s / 0.00s</span>
            </div>
            <div id="waveform"></div>
            <hr>
            <label for="quoteText">Quote Text</label>
            <input type="text" id="quoteText" placeholder="Listen to the audio and paste the full quote here...">
        </div>

        <div class="card">
            <h2>2. Timing Control</h2>
            <p>Click a word to select it. Scrub the audio to the end of that word, then press the <strong>G key</strong> or click the <strong>Set Time</strong> button.</p>
            <div class="controls">
                <button id="setTimeBtn" disabled>Set Time (G)</button>
                <button id="resetTimingsBtn" class="danger" disabled>Reset Timings</button>
                <button id="resetAllBtn" class="danger">Reset All</button>
            </div>
            <div id="words-display"></div>
        </div>

        <div class="card">
            <h2>3. Preview & Result</h2>
            <div class="preview-controls">
                <p>See how the timed glow will look in the app.</p>
                <button id="previewBtn" disabled>Preview Animation</button>
            </div>
            <div class="preview-container">
                <p id="glowing-quote-preview" class="glowing-quote"></p>
            </div>
            <hr>
            <div class="output-header">
                <label for="output">Result (JSON)</label>
                <div class="controls">
                    <button id="formatToggleBtn" disabled>Minify JSON</button>
                    <button id="copyBtn" disabled>Copy to Clipboard</button>
                </div>
            </div>
            <textarea id="output" rows="12" readonly></textarea>
        </div>
    </main>

    <!-- Link to external script -->
    <script src="script.js"></script>
</body>
</html>